# KeyWordSystem
关键信息提取
# ✅ README（PDF 关键信息抽取到 SEMAR 接入的稳健方案）

> 流程：**关键词+正则为主** → **LLM 抽取兜底** → **一致性/正确性校验** → **证据链与可追溯性** → **自动生成接入配置与示例**。

# ✅ 项目路线图（README清单 · 可逐项打钩）
面向“PDF → Markdown(Dolphin) → Schema → 校验与仲裁 → 溯源 → IoT/SEMAR配置生成”的端到端系统

---

## 0. 基础设施
- [ ] 初始化仓库与目录结构（`app/`, `tests/`, `examples/`, `docker/`, `scripts/`）
- [ ] 依赖管理（`pyproject.toml` 或 `requirements.txt`）
- [ ] 代码质量与规范（`ruff`/`flake8`、`black`、`mypy`、`pre-commit`）
- [ ] 日志与可观测性（`logging` 统一格式、请求ID、处理时长）
- [ ] 配置管理（`.env`/`pydantic-settings`，开关：LLM校验/追溯/缓存）
- [ ] 持久化（`SQLite`/`JSON` 可选；统一 `storage` 层封装）
- [ ] 单元测试与集成测试框架（`pytest` + 覆盖率报告）
- [ ] CLI 工具（`scripts/demo_cli.py`：单文件快速跑通）

---

## 1. 输入与解析（Dolphin结果对接）
- [ ] 接收 Dolphin 导出的 Markdown（文件/文本）
- [ ] **MD 块级切分**：标题/表格行/键值对/注释块
- [ ] 表格行解析（`|` 分隔，表头识别、对齐与合并单元格处理）
- [ ] 键值对解析：`key: value` / `key：value` / `key value`（鲁棒正则）
- [ ] 文本归一化：全半角、单位符号（Ω/ohm、μ/µ）、空白与标点
- [ ] 元信息保留：行号、局部上下文（上一标题、章节层级）

---

## 2. 统一 Schema（跨厂商/跨文档）
- [ ] 定义 JSON Schema（`DeviceSpec`：`device`, `params[]`）
- [ ] 别名映射词典（`vocab.py`）：`vin/operating voltage/supply voltage -> vcc`
- [ ] 值与单位拆分：`"3.3 V" -> value=3.3, unit=V`
- [ ] 数值类型尝试与范围解析：`-40~125°C`、`1.8–5.5V`、枚举与布尔
- [ ] 维持 `confidence` 初值与 `source` 占位（后续填充溯源）
- [ ] 结构化落库：存储为 JSON/SQLite（便于检索与评测）

---

## 3. 规则校验（Rule Validator）
- [ ] 范围校验：电压/电流/温度/频率（可配置阈值与容差）
- [ ] 单位一致性与换算：`mA ↔ A`、`kHz ↔ Hz`、`°C` 区间闭合性
- [ ] 逻辑一致性：最小值 ≤ 典型值 ≤ 最大值
- [ ] 维度约束：互斥参数/联动字段（如供电与功耗）
- [ ] 缺失与异常检测：空值/不合法数/文本噪声
- [ ] 规则结果结构化输出（`issues[]` + 置信度提升/降低策略）

---

## 4. LLM 校验（可选兜底）
- [ ] 提示模板：从局部上下文（表格+段落）复核字段值
- [ ] 少样本示例（few-shot）：单位与范围理解、表格错列纠正
- [ ] 冲突处理：与规则结果对比，记录分歧原因
- [ ] 预算与可控：开关/速率限制/重试策略（可完全关闭）

---

## 5. 仲裁融合（Arbiter）
- [ ] 置信度融合：规则分、LLM分、来源可靠度权重
- [ ] 冲突决策：优先级/投票/启发式（可配置）
- [ ] 输出统一 `meta`：问题清单、仲裁理由、替代值建议
- [ ] 结果标记：`status={ok|warn|fail}` 供前端可视化

---

## 6. 溯源（Provenance）
- [ ] 解析 Dolphin 产物中的页码/锚点/表格位置信息（若可用）
- [ ] 为每个 `param` 补全 `source.pdf/page/md_anchor/bbox`
- [ ] 一键回溯链接：定位到原文上下文（页码+附近文本签名）
- [ ] 溯源完整性评估（覆盖率指标：有源/无源）

---

## 7. 生成器（Generators）
- [ ] SEMAR 接入配置（`YAML`）：字段映射清单与模板
- [ ] 通用 IoT 配置（MQTT/LoRa/Wi-SUN）示例模板
- [ ] 代码/脚本生成：示例 `config.py` / `env.sh` / `curl` 脚本
- [ ] 可执行性校验：生成物语法验证与基本连通性测试
- [ ] 导出：下载打包（YAML/JSON/脚本/日志）

---

## 8. API 与最小前端
- [ ] FastAPI 路由：`POST /process(md,pdf,enable_llm=false)`
- [ ] 返回：`{doc: JSON, yaml: string, meta: issues/confidence}`
- [ ] 最小界面：上传 → 预览 Schema → 预览 YAML → 下载
- [ ] 错误处理：统一异常与可读错误码

---

## 9. 数据与评测
- [ ] 数据集组建：≥3 厂商、≥10 规格书（表格密集/文本密集/多语言）
- [ ] 标注方案：字段级金标准（键/值/单位/范围/页码）
- [ ] 指标：Precision/Recall/F1、单位/范围通过率、追溯有效率、配置可用率、端到端时延
- [ ] 基线对比：仅正则抓取 vs. 本系统（Schema+规则+仲裁+溯源+生成）
- [ ] 消融实验：去掉别名/规则/LLM/溯源/生成的影响分析
- [ ] 复现实验脚本：`scripts/eval.py`（批量跑、导出表格/图）

---

## 10. 例子与文档
- [ ] `examples/`：匿名化样例（md+pdf 片段+期望 JSON/YAML）
- [ ] README 使用指南：命令行、API、前端截图
- [ ] 架构图与数据流图（mermaid 或 PNG）
- [ ] 论文素材导出：方法流程图、表1（Schema映射）、表2（指标）

---

## 11. 部署与CI
- [ ] `Dockerfile` + `docker-compose.yml`（本地/服务器一键跑）
- [ ] GitHub Actions：lint/test/build 镜像、发布制品
- [ ] 版本化发布：`CHANGELOG.md` + 语义化版本
- [ ] 许可协议与合规（LICENSE、第三方工具引用说明）

---

## 12. 安全与隐私
- [ ] 文件清理策略：临时文件/缓存过期与大小限制
- [ ] 路径与注入防护（仅允许工作目录）
- [ ] 敏感信息屏蔽：日志脱敏（文件名/绝对路径/令牌）
- [ ] LLM 使用的隐私声明与开关

---

## 13. 质量与鲁棒性
- [ ] 多语言/多编码兼容（中/日/英 与全半角）
- [ ] 噪声处理：乱码行、错列表、单位混写
- [ ] 回退策略：缺失字段的兜底与用户提醒
- [ ] 性能：并发/批处理、长文档分段流式处理

---

## 14. 已知限制与未来工作（论文 Discussion 对应）
- [ ] 图像型表格/扫描版 PDF 的OCR误差与补救
- [ ] 复杂公式/脚注/跨页表格的识别与关联
- [ ] 更细粒度的页内定位（bbox 回放）
- [ ] 领域自适应（器件/协议/传感器子域规则库）

---

## 15. 里程碑（建议节奏）
- [ ] M1（Week 1）：MVP 跑通（解析→Schema→规则→YAML）
- [ ] M2（Week 2）：溯源+评测框架+2个样例复现
- [ ] M3（Week 3）：消融实验+前端最小界面+CI
- [ ] M4（Week 4）：数据集扩充+论文图表与对比完善

